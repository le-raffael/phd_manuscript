\chapter{Description of Plasmas}
\label{chap:PlasmaSimulations}

\vfill
\begin{chaptersummarybox}
	The kinetic description of plasmas applies the Lorentz equation to distribution functions $f$ of particle densities and velocities with appropriate collision operators.
	\begin{equation*}
		\pdv{f}{t} + \mathbf{v} \cdot \nabla_{\mathbf{x}} f + \frac{\mathbf{F}}{m} \cdot \nabla_{\mathbf{v}} f = C_{\text{coll}} + C_{\text{other}}
	\end{equation*}
	From this, conservation equations for mean quantities can be derived for density, momentum, and energy, with fluid closures to avoid higher-order moments. These equations are coupled to Gauss's, Ampère's, and Faraday's laws for magnetism.
	\begin{gather*}-
		\partial_t n + \grad\cdot\left(n\mathbf{v}\right) = S_n \qquad\qquad
		mn\left(\partial_t \textbf{v} + \textbf{v}\cdot\grad\textbf{v} \right) = -\grad p + \textbf{F} \\
		\partial_t p+\textbf{v}\cdot\grad p + \frac{5}{3}p\grad\cdot\textbf{v} = \frac{2}{3}\grad\cdot\textbf{Q}+S_E  \\
		\grad\cdot\textbf{B} = 0  \qquad\qquad \grad\cross\textbf{B} = \mu_0 \textbf{j}  \qquad\qquad \partial_t \textbf{B} = \grad\cross\left(\textbf{v}\cross\textbf{B} - \eta\textbf{j}\right) + S_\textbf{B}
	\end{gather*}
	In drift-reduced fluid models, MHD equations are projected onto the parallel direction, where the drift-ordering assumption allows to incorporate plasma drifts  in the advection terms and finite-Larmor radius effects. These models are well-suited to simulate drift-wave and interchange instabilities in the tokamak edge. Turbulence arises from electrostatic potential fluctuations  to density fluctuations in the non-adiabatic electron response in Ohm's law. These instabilities are characterized by collisional (resistive), inertial, and inductive effects, with associated parameters:
	\begin{align*}
		C &= \eta\left(\frac{qR}{L_\perp}\right)^2	&
		\mu_{eff} &= \frac{m_e}{m_i}\left(\frac{qR}{L_\perp}\right)^2 &
		\beta_{eff} &= \beta\left(\frac{qR}{L_\perp}\right)^2
	\end{align*}
	The interplay between these parameters determines whether the turbulence is driven by collisional, electron inertial, or electromagnetic effects.
\end{chaptersummarybox}
\vfill
\newpage


The difficulty in obtaining global experimental measurements in tokamaks requires complementary numerical simulations. Currently, these numerical data are essential to complement experimental measurements and support their interpretation. In the longer term, they will be used to make predictions and support the design of ITER experiments. Self-consistent simulations of the plasma edge are challenged by a complex geometry and the variety of involved scales. The magnetic equilibrium exhibits both open and closed magnetic field lines, breaking the toroidal symmetry. Turbulent fluctuations typically have sizes on the order of the ion gyroradius $\rho_\alpha$ ($\ge 0.4\, \text{mm}$)\cite{hennequin2004} in the perpendicular direction to the magnetic field lines, and compete with phenomena occurring along them on the order of the parallel connection length $\propto q_s R_0$ (where $q_s$ is the safety factor, and $R_0$ the tokamak major radius), which can extend up to 100 meters. \\

This chapter presents the different approaches to describe plasma self-consistently. In a first section \ref{sec:desc_modelHierarchy}, we explain the steps how the Lorentz force can be successively rewritten in a kinetic equation and in a conservation equations on mean plasma quantities. We extend the discussion in Sec. \ref{sec:edge_driftWaves} to drift-reduced fluid models that are commonly used for turbulent plasma simulations of the tokamak edge. Finally, we analyze in Sec. \ref{sec:edge_DAW} from a theoretical point of view the impact of electromagnetic effects on drift-wave turbulence in our models. 


\section{A hierarchy of models}
\label{sec:desc_modelHierarchy}

Plasmas can be modeled using various sets of equations that trade off between accuracy and computational feasibility. Generally, more accurate models are prohibitively expensive and are beyond the capabilities of current high-performance computing (HPC) infrastructure when applied to large systems. Depending on the scientific objective, high-fidelity models will accurately capture physical processes while reduced models complement this with full-scale simulations at relevant time scales. In this chapter, we introduce the major approaches that are used nowadays, with a special care to highlight how they are connected and where they differ. The most comprehensive approach in Sec. \ref{sec:desc_directDesciption} rely on plasma particles themselves or their statistical distribution. From there, the Chapman-Enskog expansion in Sec. \ref{sec:desc_fluidMoments} allows to express conservation equations on averaged plasma quantities and lay the foundations for fluid models. Finally, MHD models in Sec. \ref{sec:desc_MHD} offer a framework to combine those conservation equations with the evolution of electromagnetic properties of the plasma. 

\subsection{Direct description of plasma particles}
\label{sec:desc_directDesciption}
Particles are the foundation of the first set of models. They can either be solved individually as in Sec. \ref{ssec:desc_particleTracking} or represented by their distribution functions in the so-called kinetic models (Sec. \ref{ssec:desc_kineticModels}).

\subsubsection{Particle tracking}
\label{ssec:desc_particleTracking}
In the most general description, each particle in a tokamak—whether neutron, ion, atom, or electron—is represented individually with three degrees of freedom for both position $\mathbf{x}$ and velocity $\mathbf{v}$. The system's dynamics are governed by the Lorentz force:
\begin{align}
	\pdv{\mathbf{v}}{t} &= \mathbf{F} = q\mathbf{E} + q\mathbf{v} \times \mathbf{B} \label{eq:desc_particle}\\
	\pdv{\mathbf{x}}{t} &= \mathbf{v}
\end{align}
where $\mathbf{E}$ is the electric field, $\mathbf{B}$ the magnetic field, and $q$ the charge of the particle. \newline
Given that a medium-sized tokamak like WEST contains approximately $N_p \approx 10^{20}$ particles, each with six degrees of freedom, direct numerical simulation is infeasible. Computational effort can be reduced by using macro-particles, which represent many real particles. A prominent approach utilizing this concept is the particle-in-cell (PIC) method\cite{tskhakaya2007particle}, where macro-particles evolve in pre-calculated fields on a mesh or interact directly with one another. PIC methods are employed to study phenomena such as collisions with neutral particles\cite{birdsall1991particle}, plasma-wall interactions\cite{khaziev2018hpic}, or instabilities induced by fusion products\cite{cook2013particle}.



\subsubsection{Kinetic models}
\label{ssec:desc_kineticModels}
As a further abstraction, an ensemble of particles can be described statistically through a distribution function $f(\mathbf{x}, \mathbf{v},t)$. This kinetic description replaces individual particles with a probability distribution, avoiding the need to calculate exact positions and velocities at each moment in time. The behavior of the distribution function is governed by the Boltzmann equation:
\begin{equation}
	\label{eq:BoltzmannEquationKineticDescription}
	\pdv{f}{t} + \mathbf{v} \cdot \nabla_{\mathbf{x}} f + \frac{\mathbf{F}}{m} \cdot \nabla_{\mathbf{v}} f = C_{\text{coll}} + C_{\text{other}}
\end{equation}
where $C_{\text{coll}}$ represents the collision operator, handling Coulomb collisions as introduced in Sec. \ref{sec:intro_collisions}, and $C_{\text{other}}$ includes additional source terms. Substituting the force vector $\mathbf{F}$ with the Lorentz force (Eq. \ref{eq:desc_particle}) yields the Vlasov equation. \newline

To achieve sufficient accuracy, approximately $N_x = 10^9$ spatial discretization points and $N_\sigma = 10^6$ points for the distribution function are required. Considering that both position and velocity have three components each, this results in $6 \cdot 10^{15}$ degrees of freedom—significantly fewer than in the particle description. \newline

Further simplification is achieved through the gyrokinetic approach. While particles in a plasma predominantly follow magnetic field lines, their motion forms a helical trajectory characterized by the Larmor frequency and radius:

\begin{equation}
	\omega_L = \frac{eZB}{m} \qquad\qquad l_L = \frac{mv_\perp}{eZB}
\end{equation}

This allows the elimination of one degree of freedom in the distribution function, as the velocity can be described by its parallel component $v_\parallel$ along the magnetic field line and its perpendicular component $v_\perp$. This simplification is valid only when the Larmor frequency and radius are much smaller than any characteristic frequency or length in the system, which is typically true in the core of the tokamak but not in the scrape-off layer (SOL), where the gyrokinetic approach is less suitable. \\

Gyrokinetic models are particularly useful to study transport barriers and turbulence driven by ion and electron temperature gradients (ITG/ETG) or trapped electron mode (TEM) instabilities and typically use full-\textit{f} turbulence models. The code GYSELA\cite{grandgirard2007global,grandgirard20165d} follows a semi-Lagrangian method to study core turbulence, zonal flows an neoclassical transport and is capable of relatively long simulated plasma times. Plasma-wall interactions and kinetic neutrals make XGC\cite{hager2022} particularly well-suited for edge and SOL turbulence. It allowed for comprehensive divertor heat exhaust studies\cite{chang2017gyrokinetic} and is capable of complex 3D magnetic configurations found in stellarators\cite{cole2019verification}. The Eulerian code GENE-X\cite{goerler2011global,michels2021gene} is ideal for full-\textit{f} electromagnetic simulations of turbulence at multiple scale in the core-edge region. 


\subsection{Three fluid moments of the kinetic equation}
\label{sec:desc_fluidMoments}
Deriving transport equations for plasma quantities analogous to the Navier-Stokes equations in classical fluid dynamics is highly desirable. Such an approach would enable the use of established computational fluid dynamics (CFD) methods for turbulence modeling, significantly reducing the number of degrees of freedom. Starting with the distribution function $f$, the $k$-th moment of the transport equation is obtained by applying the tensor product $\mathbf{v} \otimes \dots$ $k$ times and then integrating over the velocity:

\begin{equation}
	\mathcal{M}^k = \int_\mathbf{v} f\mathbf{v}^k d\mathbf{v}^3
\end{equation}

Substituting the kinetic equation \ref{eq:BoltzmannEquationKineticDescription} into this expression yields the following equation for the $k$-th moment:

\begin{align}
	\partial_t \int_\mathbf{v} f\mathbf{v}^k d\mathbf{v}^3 + \int_\mathbf{v} \mathbf{v}^k \mathbf{v} \cdot \nabla_{\mathbf{x}} f d\mathbf{v}^3 + \int_\mathbf{v} \mathbf{v}^k \frac{\mathbf{F}}{m} \cdot \nabla_{\mathbf{v}} f d\mathbf{v}^3 &= \int_\mathbf{v} \mathbf{v}^k C d\mathbf{v}^3 \nonumber \\
	\partial_t \mathcal{M}^k + \nabla_{\mathbf{x}} \cdot \mathcal{M}^{k+1} - \frac{k}{m} \mathbf{F} \otimes \mathcal{M}^{k-1} &= \int_\mathbf{v} \mathbf{v}^k C d\mathbf{v}^3 \label{eq:desc_generalMomentsEq}
\end{align}

Expressing the $k$-th moment requires knowledge of the $k-1$-th and $k+1$-th moments. Consequently, a fully consistent plasma description would require infinitely many equations, which is impractical. Therefore, we typically consider only the first three moments, using fluid closures to compensate for the missing higher-order equations. These moments effectively allow us to replace a particle-based description with averaged quantities:

\begin{align}
	&\text{Particle density:} & \mathcal{M}^0 &= n = \int_\mathbf{v} f d\mathbf{v}^3 && \left[\text{m}^{-3}\right] \\
	&\text{Momentum density:} & \mathcal{M}^1 &= \boldsymbol{\gamma}  = n \mathbf{u} = \int_\mathbf{v} f \mathbf{v} d\mathbf{v}^3 && \left[\text{m}^{-2} \cdot \text{s}^{-1}\right] \\
	&\text{Pressure tensor:}   &  m \mathcal{M}^2 &= \boldsymbol{\Pi} = m \int_\mathbf{v} f \mathbf{v} \otimes \mathbf{v} d\mathbf{v}^3 && \left[\text{kg} \cdot \text{m}^{-1} \cdot \text{s}^{-2}\right]
\end{align}

where $\mathbf{u}$ is the fluid velocity and $m$ the particle mass. This framework sets the stage for deriving the three fundamental conservation equations for fluid models of plasmas.



\subsubsection{Mass conservation (\textit{k} = 0)}

Starting from Eq. \ref{eq:BoltzmannEquationKineticDescription}, the mass balance equation for the unknowns $n$ and $\mathbf{u}$ is derived as follows:
\begin{equation}
	\label{eq:ZeroMomentTransportEquation}
	\partial_t n + \nabla \cdot (n\mathbf{u}) = S_n
\end{equation}
This equation provides one relation but involves four unknowns, necessitating additional equations to fully describe the system. The term $S_n$ accounts for particle sources arising from non-elastic collisions in $C_{\text{other}}$, such as ionization or recombination processes.

\subsubsection{Momentum conservation (\textit{k} = 1)}

For the first moment equation, we multiply the Boltzmann equation \ref{eq:BoltzmannEquationKineticDescription} by $\mathbf{v}$ and integrate over the velocity space, yielding:
\begin{equation}
	\partial_t \left( \int_\mathbf{v} \mathbf{v} f d\mathbf{v} \right) + \int_\mathbf{v} \mathbf{v} \otimes \mathbf{v} \cdot \nabla_{\mathbf{x}} f d\mathbf{v} + \int_\mathbf{v} \mathbf{v} \frac{\mathbf{F}}{m} \cdot \nabla_{\mathbf{v}} f d\mathbf{v} = \int_\mathbf{v} C \mathbf{v} d\mathbf{v}
\end{equation}
To simplify the tensor product, we decompose the velocity $\mathbf{v}$ into the fluid velocity $\mathbf{u}$ and a new quantity $\mathbf{w}$, such that $\mathbf{v} = \mathbf{u} + \mathbf{w}$. We introduce the static pressure tensor:
\begin{equation}
	\boldsymbol{P} = m \int_\mathbf{w} f \mathbf{w} \otimes \mathbf{w} d\mathbf{w}
\end{equation}
The pressure tensor $\boldsymbol{\Pi}$ can then be expressed as:
\begin{equation}
	\boldsymbol{\Pi} = m \int_\mathbf{w} f \mathbf{u} \otimes \mathbf{u} d\mathbf{w} + m \int_\mathbf{w} f \mathbf{w} \otimes \mathbf{w} d\mathbf{w} = mn \mathbf{u} \otimes \mathbf{u} + \boldsymbol{P}
\end{equation}
Substituting this into the first moment equation, we obtain the conservation equation for momentum:
\begin{equation}
	\label{eq:FirstMomentTransportEquation}
	m \partial_t (n \mathbf{u}) + m \nabla \cdot \left( n \mathbf{u} \otimes \mathbf{u} + \boldsymbol{P} \right) = enZ \mathbf{E} + enZ \mathbf{u} \times \mathbf{B} + S_u + R
\end{equation}
Here, $S_u$ represents the momentum source term, and $R$ accounts for friction, both arising from $C_{\text{coll}}$ and $C_{\text{other}}$.

\subsubsection{Energy conservation (\textit{k} = 2)}
\label{ssec:desc_energyBalance}
Finally, to solve for the static pressure tensor $\boldsymbol{P}$, we assume isotropic pressure in the plasma, simplifying the pressure tensor to a scalar pressure $p$ such that $\boldsymbol{P} = p \boldsymbol{I}$. This reduces the nine unknowns in $\boldsymbol{P}$ to a single scalar $p$. Given that $p = nT$, the second moment can be expressed as an energy conservation equation. The total energy density $\varepsilon$ is the sum of kinetic and thermal energy in the plasma:
\begin{equation}
	\varepsilon = \frac{3}{2} nT + \frac{1}{2} mn \norm{\mathbf{u}}^2
\end{equation}
To derive a conservation equation for $\varepsilon$, we multiply Vlasov's equation \ref{eq:BoltzmannEquationKineticDescription} by the kinetic energy per unit mass:
\begin{equation}
	\partial_t \left( \int_\mathbf{v} \frac{1}{2} u^2 f d\mathbf{v} \right) + \int_\mathbf{v} \frac{1}{2} u^2 \mathbf{v} \cdot \nabla_{\mathbf{x}} f d\mathbf{v} + \int_\mathbf{v} \frac{1}{2} u^2 \frac{\mathbf{F}}{m} \cdot \nabla_{\mathbf{v}} f d\mathbf{v} = \int_\mathbf{v} \frac{1}{2} u^2 C d\mathbf{v}
\end{equation}
This simplifies to:
\begin{equation}
	\label{eq:SecondMomentTransportEquation}
	\partial_t \varepsilon + \nabla \cdot \left( \varepsilon \mathbf{u} + \left[ n \mathbf{u} \otimes \mathbf{u} + \boldsymbol{P} \right] \cdot \mathbf{u} + \mathbf{q} \right) = enZ \mathbf{E} \cdot \mathbf{u} + Q + R_\varepsilon
\end{equation}
The collisional heat flux $\mathbf{q}$ arises from the fluid closure, replacing all higher-order moments. The term $Q$ represents a collisional heat source, while $R_\varepsilon$ accounts for sources associated with non-Coulombian collisions in $C_{\text{other}}$. Notably, the magnetic field term $\mathbf{u} \times \mathbf{B}$ does not appear in the energy equation, as the torque $\frac{1}{2} u^2 \mathbf{u} \times \mathbf{B} \cdot \nabla_{\mathbf{v}} f$ does not perform work and therefore does not contribute to energy changes. \newline

The three conservation equations for density $n$, momentum $\boldsymbol{\gamma}$, and energy $\varepsilon$ form the foundation of the SOLEDGE3X framework. The exact model will be given in Chap. \ref{chap:SOLEDGE3X_framework}.



\subsection{MHD description of plasmas}
\label{sec:desc_MHD}
In the magnetohydrodynamics (MHD) approach, the conservation equations are coupled to Maxwell's and Ohm's laws, introducing electromagnetic behavior into the system. Unlike earlier models, the magnetic equilibrium is not static; the electric and magnetic fields evolve over time. MHD models typically differentiate between ideal MHD and extended models that include resistive and two-fluid effects, which are essential for accurately describing tokamak plasmas. The ideal MHD model and its extension with tokamak-specific terms in Sec. \ref{ssec:desc_extendedMHD} is the most accurate approach to simulate the electromagnetic intrications in plasmas. Fast wave dynamics represent a major restriction and reduced models in Sec. \ref{ssec:desc_reducedMHD} are therefore much more widespread. 

\subsubsection{Extended MHD model}
\label{ssec:desc_extendedMHD}
Many of the explanations in this section are based on the lecture notes by E. Franck\cite{lessig2016fluid}. The complete set of MHD equations is as follows:
\begin{align}
	\partial_t n + \nabla \cdot (n \mathbf{u}) &= 0 \label{eq:desc_MHDmass} \\
	mn\partial_t\mathbf{u} + mn\mathbf{u}\cdot\nabla\mathbf{u} + \nabla p &= \mathbf{j} \times \mathbf{B} \boxed{- \nabla \cdot \boldsymbol{\Pi}} \label{eq:desc_MHDmomentum} \\
	\frac{3}{2}\partial_t p_i + \frac{3}{2} \mathbf{u} \cdot \nabla p_i + \frac{5}{2}p_i \nabla \cdot \mathbf{u} &= \boxed{- \nabla \cdot \mathbf{q}_i - \nabla \cdot (\boldsymbol{\Pi}_i : \nabla \mathbf{u})} \label{eq:desc_MHDionpressure} \\
	\frac{3}{2}\partial_t p_e + \frac{3}{2} \mathbf{u} \cdot \nabla p_e + \frac{5}{2}p_e \nabla \cdot \mathbf{u}  &= \boxed{- \nabla \cdot \mathbf{q}_e - \nabla \cdot (\boldsymbol{\Pi}_e : \nabla \mathbf{u}) + \eta \norm{\mathbf{j}}^2 + \frac{3}{2}\mathbf{j}\cdot \bm{\mathcal{P}}} \label{eq:desc_MHDelectronpressure} \\
	\partial_t \mathbf{B} &= -\nabla \times \left(-\mathbf{u} \times \mathbf{B} \boxed{+ \eta \mathbf{j} - \bm{\mathcal{P}} + \bm{\mathcal{H}}}\right) \label{eq:desc_MHDohmlaw} \\
	\nabla \cdot \mathbf{B} &= 0 \label{eq:desc_MHDgausslaw} \\
	\grad \times \mathbf{B} &= \mu_0 \mathbf{j} \label{eq:desc_MHDamperelaw}
\end{align}

Equations \ref{eq:desc_MHDmass} through \ref{eq:desc_MHDamperelaw} are derived directly from the fluid moments described in Sec. \ref{sec:desc_fluidMoments}, where the pressure replaces the energy and is solved for both ions and electrons. These equations are coupled with Ohm's law (Eq. \ref{eq:desc_MHDohmlaw}) under the magnetostatic assumption, Gauss's law for magnetism (Eq. \ref{eq:desc_MHDgausslaw}), and Ampère's law (Eq. \ref{eq:desc_MHDamperelaw}). In ideal steady-state, we see that the momentum balance is dominated by the equilibrium between thermodynamic and magnetic forces $\grad p = \mathbf{j}\cross\mathbf{B}$. In combination with Ampère's law, all components are available to derive the Grad-Shafranov equation \ref{eq:intro_GradShafranovEquation} as it has been done in Sec. \ref{sec:intro_GradShafranov}. \\
The terms enclosed in boxes represent the additional terms required for extending the model from ideal MHD. These include viscous-resistive effects, as well as a pressure term $\bm{\mathcal{P}}$ and a Hall term $\bm{\mathcal{H}}$. Without these boxed terms, the system describes the ideal MHD model. Linearizing the ideal MHD equations results in three types of waves:
\begin{itemize}
	\item \textbf{Alfvén waves}: These incompressible waves cause the magnetic field lines to bend and propagate only in the parallel direction. In the low-beta limit, their propagation speed, $v_A^2 = \frac{B^2}{mn\mu_0}$, is much greater than the speed of sound in the plasma, $c_s^2 = \frac{eT}{m}$.
	\item \textbf{Slow magnetoacoustic waves}: These waves propagate only in the parallel direction, causing compression in the plasma without perturbing the magnetic field lines. Their propagation speed $v_s$ is similar to the speed of sound.
	\item \textbf{Fast magnetoacoustic waves}: These waves can propagate in any direction and compress magnetic field lines. They have a propagation speed approximately given by $v_f^2 = v_A^2 + c_s^2$.
\end{itemize}

Fast waves, in particular, pose challenges for numerical modeling as they require very small timesteps and implicit methods to be accurately resolved. The full MHD model introduces two additional dispersive waves into the system.


\subsubsection{Reduced MHD model}
\label{ssec:desc_reducedMHD}
To eliminate the fast magnetoacoustic waves and to reduce the size of the system, physicists often resort to reduced MHD models. Instead of solving for all components of $\mathbf{B}$, we decompose the magnetic field into the the polodial flux $\Psi$ and the toroidal field function $F$ as in Eq. \ref{eq:intro_BeqMagneticFluxes}. The toroidal field $B_\varphi$ and $F$ are imposed, so we only remain with the unknown scalar $\Psi$ to replace the three unknowns of $\mathbf{B}$. As a reminder from Sec. \ref{sec:intro_GradShafranov}, $\Psi$ is equivalent to the toroidal component $A_\varphi$ of the magnetic vector potential and uniquely defines the poloidal field $B_p$. Consequently, Ampère's law \ref{eq:desc_MHDamperelaw} reduces to: 

\begin{equation}
	\mu_0 j_\varphi = \Delta^* \Psi = R^2\grad\cdot\left(\frac{1}{R^2}\grad_p\Psi\right)
\end{equation}

with the poloidal gradient $\grad_p$. \\

In the second simplification for the reduced MHD model, the velocity vector is decomposed into a parallel and a perpendicular component. The projected fields are:

\begin{align}
	u_\perp     &= \mathbf{e}_\varphi\cdot \grad\cross\left(R^2\mathbf{u}\right)  \\
	u_\parallel &= \mathbf{B}\cdot\mathbf{u} \\
\end{align}

This projection is consequently applied to all terms in the momentum conservation equation \ref{eq:desc_MHDmomentum}, that can then be solved independently for both velocities. In addition to reducing the number of equations from three to two, it permits to split the slow magnetoacoustic waves, that propagate at sound speed in the parallel directions, from the much slower dynamics in the poloidal plane that consist of electric and diamagnetic drifts. \\

The JOREK code\cite{huysmans2007mhd,hoelzl2021jorek} for example is a fully implicit simulation framework that includes several levels of MHD reduction. It works on diverted magnetic configuration and considers advanced SOL physics. It is mainly used to study the dynamics, cycles and control of edge-localized modes (ELMs), as well as disruptions in form of thermal and current quenches. 


\subsubsection{Fluid closures}
\label{sec:desc_fluidClosures}

We only considered MHD models up to the second moment. To maintain the validity of the model, we need additional closure terms in the momentum and energy equations. Braginskii\cite{braginskii1965transport} proposed a set of forces and heat fluxes that apply to the momentum and energy conservation equations. They originate the assumption of a weakly collisional plasma in line with the Spitzer-Härm model presented in Sec. \ref{ssec:intro_macroscopicEffectsPlasma}. Because of the strong magnetic fields in a tokamak, collisional phenomena experience a strong anistropy and it is appealing to split them in a parallel and perpendicular direction to the magnetic equilibrium. We can then define the pressure tensor and the viscous stress tensor:

\begin{align}
	\textbf{P} =& p_\perp\textbf{I} + (p_\parallel-p_\perp)\textbf{b}\textbf{b} \\
	\boldsymbol{\Pi} =& \boldsymbol{\Pi}_\parallel + \boldsymbol{\Pi}_\perp = \eta_\parallel\grad_\parallel \textbf{v}_\parallel + \eta_\perp\grad_\perp \textbf{v}_\perp
\end{align}

The unit vector $\textbf{b}$ defines the direction of the magnetic field. Similarly, the heat flux is decomposed in its parallel and perpendicular components:

\begin{equation}
	\textbf{q} = q_\parallel \textbf{b} + \textbf{q}_\perp = -\kappa_\parallel \grad_{\parallel}T - \kappa_\perp \grad_{\perp}T
\end{equation}

Braginskii only considered electrons and one type of ions, The work was extended by Zhdanov\cite{zhdanov2002transport} to handle multi-species plasmas. Particle collisions between different species lead to a friction force, proportional to the velocity difference, and a thermal force along the temperature gradient. For a species $\alpha$, the contribution of all other species $\beta$ to these forces is:

\begin{equation}
	\textbf{F}_\alpha  =\sum_\beta \underbrace{-\omega_{\alpha\beta}m_\alpha n_\alpha(\mathbf{v_\alpha}-\mathbf{v}_\beta)}_{\text{Friction}} \underbrace{-\frac{m_\alpha n_\alpha}{eZ_\alpha}\delta_\alpha\grad T_\alpha}_{\text{Thermal}}
\end{equation}

The coefficient $\delta_\alpha$ describes the thermal diffusion of particles driven by the temperature gradient. For electron-ion collisions, the friction force corresponds to the electric to the current resistive. The force $\textbf{F}_\alpha$ needs to be included in the conservation equations in the closure. An instanteneous force balance on electrons, projected on the parallel direction, gives a first expression for the generalized Ohm's law in plasmas:

\begin{equation}
	\eta_\parallel j_\parallel = E_\parallel + \frac{1}{n_e}\grad p_e + 0.71\grad{T_e}
\end{equation}



\section{Drift-reduced models for plasma turbulence}
\label{sec:edge_driftWaves}


Kinetic models based on the particle distribution function\cite{DifPradalier_2009, Charidakos_2018} are still limited to fundamental studies because of their very high numerical cost in a (5) 6-dimensional phase space. Thus, when realistic configurations are considered, reduced-dimension (2D/3D) fluid models remain the only feasible option for studying transport and turbulence at the edge of the plasma, although they are only rigorously valid in collisional regimes. A wide range of models have been derived in the literature and implemented in state-of-the-art codes\cite{DUDSON_2009, giacomin2022gbs, stegmeir2019} (see also an exhaustive presentation in the recent review by Schwander \emph{et al.}\cite{SCHWANDER_2024}). The basic assumption they share is that the turbulence is characteristically low frequency and long wavelength in nature, leading to a strong scale separation between the parallel and perpendicular directions to the magnetic field. Therefore, the plasma fluid motion perpendicular to the magnetic field can be described explicitly by the so-called velocity drifts given by the quasi-static balance between Lorentz force, pressure gradient, and electromotive force due to magnetic and electric field inhomogeneities. \\

We first explain in Sec. \ref{ssec:edge_driftOrdering} how drifts allow to formulate the drift-ordering assumption, which is at the root of fluid models. The section is concluded in \ref{ssec:edge_linearDriftWaves} with an overview onver the instabilities caught by the model. 


\subsection{Drift-ordering approximation}
\label{ssec:edge_driftOrdering}
The separation of scales allows for fluid-drift models, where the parallel and perpendicular momentum equations are treated independently. Mikhailovskii and Tsypin\cite{mikhailovskii1971transport} first described slow drift dynamics from a theoretical viewpoint in 1971 with $\rho_L = 0$. Hazeltine \emph{et al.}\cite{hazeltine1985four} extended the framework to include a finite ion Larmor radius. We focus on low-$\beta$ collisional plasmas, typically found in the edge region of a tokamak. In such plasmas, we can define a characteristic length scale $L_\parallel$ for parallel phenomena, which is on the order of the machine size (e.g., the major radius $R$), where gradients in plasma fields such as density, temperature, or magnetic field strength are established. The perpendicular scale $L_\perp$ is characteristic of cross-field structures. These scales define the parallel and perpendicular wave numbers $k_\parallel$ and $k_\perp$. In the drift ordering, the following relationships hold\cite{simakov_2003}:

\begin{align}
	\beta = \frac{2\mu_0(p_e + p_i)}{B^2} &\ll 1 & \frac{\rho_L}{L_\perp} \sim \frac{\lambda_c}{L_\parallel} &\ll 1
\end{align}

where $\rho_L$ is the ion Larmor radius, and $\lambda_c$ is the mean free path between collisions. The electric force is much weaker than the magnetic force. Similarly, characteristic plasma frequencies should be much lower than the ion cyclotron frequency, giving rise to the following ordering parameters:

\begin{align}
	\epsilon_E &= \frac{mE}{eZB^2} \ll 1 & \epsilon_l &= \frac{L_\perp}{L_\parallel} \ll 1 & \epsilon_t &= \frac{\omega_\perp}{\omega_L} \ll 1
\end{align}

The averaged gyromotion of particles is parallel to the magnetic field lines, with parallel velocities $v_\parallel \approx \sqrt{2T/m}$ consistent with the kinetic energy in the plasma. Drift velocities, on the other hand, are typically much slower. Since $\nabla B$ and the curvature radius $R_c$ occur at machine scales $L_\parallel$, we can provide orders of magnitude for the drift velocities introduced in Sec. \ref{ssec:intro_plasmaDrifts}:

\begin{align}
	v_E \sim& \epsilon_E v_\parallel & v_{\nabla B} \sim& \epsilon_l v_\parallel & v_c \sim& \epsilon_l v_\parallel  & v_p \sim& \epsilon_t v_\parallel
\end{align}

This leads to the assumption in the Lorentz equation \ref{eq:edge_LorentzEquationDecomposition} that the perpendicular acceleration is negligible compared to parallel dynamics, such that $m\partial_t v_\perp \approx 0$. For the perpendicular velocity, we project the momentum conservation equation onto the perpendicular direction:

\begin{align}
	\mathbf{b}\cross\left[\partial_t \left(mn\mathbf{v}\right) + \grad\cdot\left(mn\mathbf{v}\otimes\mathbf{v}\right)\right] =& -\mathbf{b}\cross\grad p_\perp - \mathbf{b}\cross\grad\cdot\bar{\bar{\Pi}} + nq\mathbf{b}\cross\mathbf{E} \nonumber\\ & \qquad + nq\left(\mathbf{b}\cross\mathbf{v}\cross\mathbf{B}\right) + \mathbf{b}\cross\mathbf{R} + \mathbf{b}\cross\mathbf{S}_u \nonumber \\
	\Leftrightarrow\qquad \qquad \qquad
	\mathbf{v}_\perp =& \frac{\mathbf{b}\cross\grad p}{enZB} + \frac{\mathbf{b}\cross\grad\cdot\bar{\bar{\Pi}}}{enZB} +  \frac{\mathbf{E}\cross\mathbf{b}}{B} + \frac{\left(\textbf{R}+\textbf{S}\right)\cross\mathbf{b}}{enZB} \nonumber\\ & \qquad + \frac{\mathbf{b}}{enZB} \cross \left(\partial_t \left(mn\mathbf{v}\right) + \grad\cdot\left(mn\mathbf{v}\otimes\mathbf{v}\right)\right)
\end{align}

In addition to the diamagnetic, electric and polarization drifts $\mathbf{v}^*$, $\mathbf{v}_E$ and $\mathbf{v}_{p}$known from Sec. \ref{ssec:intro_plasmaDrifts}, we introduce here the parallel viscous stress and friction force drifts $\mathbf{v}_{\perp,\Pi}$ and $\mathbf{v}_{\perp,S}$. The expression for the perpendicular velocity $\mathbf{v}_\perp$ is not explicit as the right-hand side depends on the full velocity vector. However, we can fairly well approximate it with two calculation steps. All terms that do not depend on $\textbf{v}$ are first evaluated to get $\mathbf{v}_\perp^{(0)}$ (and with equation \ref{eq:RelationPerpParallelVelocity} we can also calculate $\mathbf{v}^{(0)}$), and then $\mathbf{v}_\perp^{(1)}$ is calculated by replacing every occurrence of $\mathbf{v}$ by $\mathbf{v}^{(0)}$. 
\begin{align}
	\mathbf{v}_\perp^{(0)} =& \frac{\mathbf{b}\cross\grad p}{enZB} + \frac{\mathbf{E}\cross\mathbf{b}}{B} = \mathbf{v}_* + \mathbf{v}_E \label{eq:VelPerp0Component} \\	
	\mathbf{v}_\perp^{(1)} =& \frac{\mathbf{b}\cross\grad\cdot\bar{\bar{\Pi}}(\mathbf{v}^{(0)})}{enZB} - \frac{\mathbf{b}\cross\left(R(\mathbf{v}^{(0)})+S(\mathbf{v}^{(0)})\right)}{enZB} \nonumber\\ & \qquad + \frac{\mathbf{b}}{n\omega_c} \cross \left(\partial_t \left(n\mathbf{v}^{(0)}\right) + \grad\cdot\left(n\mathbf{v}^{(0)}\otimes\mathbf{v}^{(0)}\right)\right) \nonumber \\
	=& \mathbf{v}_{\perp,\Pi} + \mathbf{v}_{\perp,S} + \mathbf{v}_{p} \label{eq:VelPerp1Component} \\
	\mathbf{v}_\perp \approx& \mathbf{v}_\perp^{(0)} + \mathbf{v}_\perp^{(1)}
\end{align}

This simplification holds because the contribution of $\mathbf{v}_\perp^{(1)}$ is small, of the order of $\epsilon_t$. Next, let us extract the divergence free contribution from the diamagnetic flux $n\mathbf{v}^*$.

\begin{align}
	\label{eq:definitionDiamagneticDrift}
	n\mathbf{v}^* =& -\grad \cross \frac{p\mathbf{B}}{eZB^2} + n\tilde{\mathbf{v}}^* \nonumber\\
	& \quad\text{with: } \tilde{\mathbf{v}}^* = \frac{2T\mathbf{B}\cross\grad B}{eZB^3} + \frac{T}{eZB^2}\grad\cross\mathbf{B}
\end{align}

The second term in $\tilde{\mathbf{v}}^*$ accounts for the "gradB" and curvature drifts. The polarization drift $v_{p}$ in Eq. \ref{eq:VelPerp1Component} can be found through algebraic manipulations and neglecting some small curvature terms:

\begin{align}
	n\mathbf{v}_{p} =& \partial_t\boldsymbol{\omega} - \grad\cdot\left(\mathbf{v}^{(0)}\otimes\boldsymbol{\omega}\right) \nonumber \\
	&\text{with: } \boldsymbol{\omega} = \frac{m}{eZB^2}\left(n\grad_\perp\Phi + \grad_{\perp}\left(p-\frac{\pi_\parallel}{3}\right)\right) - \frac{m}{q^2B^2}S_{\textbf{v}_\perp} \label{eq:definitionSmallOmega}
\end{align}

Let us introduce the vorticity $ \boldsymbol{\Omega} = \nabla \times \mathbf{v}$, which measures the local rotation of a fluid element. It is a vector quantity, where the direction indicates the axis of rotation and its magnitude indicates the strength of the rotational motion. As perpendicular phenomena are essentially described by the parallel component of $\boldsymbol{\Omega}$, we only solve for the conservation of $\Omega_\parallel$. 

\begin{equation}
	\Omega_\parallel = \mathbf{b} \cdot \nabla \times \mathbf{v}_p = \nabla \cdot \boldsymbol{\omega}
\end{equation}

With the expression of the polarization drift, we obtain a conservation equation for the ion vorticity:

\begin{equation}
	\label{eq:edge_vorticityConservation}
	\frac{n_im_i}{q_iB^2}\left(\partial_t\Omega_\parallel + (v_{i,\parallel}\mathbf{b} + \mathbf{v}_{i,\perp})\cdot\nabla\Omega_\parallel\right) = \nabla \cdot \left(j_\parallel\mathbf{b} + \mathbf{j}_\perp - en\mathbf{v}_E\right)
\end{equation}

where the perpendicular current arises from drifts in opposite directions for electrons and ions, $\mathbf{j}_\perp = q_i n_i \mathbf{v}_{i,\perp} - q_e n_e \mathbf{v}_{e,\perp}$. There is a "grad B," curvature, and polarization current, but no "ExB" current, as the electric drift is independent of the species' mass and charge. The parallel current density is given by Ohm's law:

\begin{equation}
	\eta_\parallel j_\parallel + \frac{m_e}{e}\frac{dj_\parallel}{dt} = E_\parallel + \frac{\nabla_\parallel p_e}{n_e} + 0.71\nabla_\parallel T_e
\end{equation}

In the first order, the evolution of the perpendicular electric field derives from the evolution of the potential gradient $d\mathbf{E}_\perp / dt = -d\nabla_\perp \Phi / dt$. The full electric field is given by:

\begin{align}
	\mathbf{E}_\perp &= -\nabla_\perp \Phi &
	E_\parallel &= -\nabla_\parallel \Phi - \partial_t A_\parallel
\end{align}

where the time variation $\partial_t A_\parallel$ accounts for magnetic induction effects. \newline

A full derivation of the drift-reduced equations, including all possible terms, was provided by Simakov and Catto\cite{simakov_2003}. Notably, they derived a self-consistent expression for the ion parallel and gyroviscous stress tensors, ensuring full energy conservation in the fluid model.




\subsection{Linear plasma instabilities}
\label{ssec:edge_linearDriftWaves}

To understand how turbulent structures appear and travel in the plasma, it is essential to understand the physical mechanisms covered by the drift-reduced equations. In this section, we delve into the different linear phenomena that appear plasma in the SOL.



\subsubsection{Non-adiabatic drift waves}
\label{ssec:edge_nonAdiabaticResponse}
One key mechanism within this framework is the non-adiabatic density response to potential perturbations. In this context, resistivity induces a phase shift between density and potential perturbations, which can either amplify or dampen these perturbations. The Hasegawa-Wakatani model\cite{hasegawa1983plasma} provides a foundational understanding of this process. This model considers an isothermal plasma with an unsheared magnetic field, where particles are advected solely by the electric drift, and parallel ion motion is neglected. We assume that the magnetic field is purely toroidal, and radial density gradients are imposed by the pressure gradient. We then remain with two degrees of freedom on which to perform the linear analysis: a perpendicular, poloidal direction and a parallel, toroidal direction. Perturbations on any quantity are expressed as $ X = X_0(\psi) + \tilde{X}(\theta,\varphi) $, with $\tilde{X}(\theta,\varphi) = \epsilon e^{i(-\omega t + k_\perp\theta+k_\parallel\varphi )}$ and the equilibrium fields $ X_0 $ varies across flux surfaces. Radial density gradients are imposed from the pressure gradient and can be approximated $\partial_\psi n_0 = \bar{n}_0 / \lambda_p$ where $\lambda_p$ is a characteristic length for the pressure gradient. In a slab equations, the perpendicular direction is hence perpendicular to both the magnetic field and the density gradient. The governing equations are:

\begin{align}
	\partial_t n + \mathbf{v}_E \cdot \nabla n &= \frac{1}{e} \nabla \cdot (j_\parallel \mathbf{b}) \\
	\eta_\parallel j_\parallel &= T_0 \nabla_\parallel \log(n) - \nabla_\parallel \Phi \\
	\grad\cdot\frac{nm_i}{B^2} \left(\partial_t \nabla_\perp \Phi + \mathbf{v}_E \cdot \nabla \nabla_\perp \Phi\right) &= \nabla \cdot (j_\parallel \mathbf{b})
\end{align}

The advection term by the electric drift can be expressed using Poisson brackets:
\begin{align}
	\mathbf{v}_E\cdot\grad n &= -\frac{1}{B}\left(\grad\Phi\cross \mathbf{b} \right)\cdot\grad n = -\frac{1}{B} \left(\partial_\theta\Phi \partial_\psi n - \partial_\psi\Phi \partial_\theta n\right) \nonumber \\ 
	&= -\frac{1}{B}\left[\Phi,n\right]_{\psi,\theta} \label{eq:edge_poissonBracket}
\end{align}

The wavenumber vector $ \mathbf{k} $ contains both parallel and perpendicular components, such that in the Fourier space $ k_\parallel^2 \sim \nabla_\parallel^2 $ and $ k_\perp^2 \sim \nabla_\perp^2 $. Using the ion Larmor radius $\rho_L^2 = T_0m_i/(eB^2)$, the dispersion relation for the system is: 

\begin{equation}
	\omega^2 + i\frac{1 + \rho_L^2k_\perp^2}{\rho_L^2k_\perp^2}\frac{T_0k_\parallel^2}{en_0\eta_\parallel}\omega - i\frac{1}{\rho_L^2k_\perp^2}\frac{T_0^2k_\perp k_\parallel^2}{en_0B\lambda_p\eta_\parallel} = 0
\end{equation}


The solution to this system can be decomposed into a real component $ \omega_* $ that corresponds to the natural frequency of the system and an imaginary component $ \gamma $ that describes the growth or damping rate. From the drift-ordering parameters, we know that $ k_\perp^2 \rho_L^2 $ must be small, simplifying the system. If we assume the resistivity small, we can estimate the solutions:

\begin{align}
	\omega_* &= \frac{T_e k_\perp}{B\lambda_p} & \gamma &= \frac{\rho_L^2k_\perp^2en_0\eta_\parallel}{T_0k_\parallel^2}\omega_*^2
\end{align}

The system frequency $ \omega_* $ is called the diamagnetic frequency and is driven by the density gradient. We observe that the growth rate $ \gamma $ is positive, indicating that under certain conditions, perturbations may grow indefinitely. The more resistive a plasma is, the faster perturbations grow and in an ideal plasma with zero resistivity, the system remains stable with the single real solution $\omega_*$. In this case, the interaction is adiabatic, and density and potential oscillate in phase at the diamagnetic frequency.


\subsubsection{Sound waves}

Parallel ion motion produces sound waves. If we consider only the parallel velocity, the conservation equation can be expressed in a reduced form:

\begin{align}
	\partial_t n + \nabla \cdot (v_\parallel n\mathbf{b}) &= 0 \\
	m_i n \left(\partial_t v_\parallel + \nabla \cdot \left(v_\parallel^2 \mathbf{b}\right)\right) &= -\nabla_\parallel (p_i + p_e)
\end{align}

Density and velocity perturbations then travel in the parallel direction at the sound speed $ c_s = \sqrt{e(T_e + T_i)/m_i} $. Sound waves do not lead to instabilities nor do they grow or damp, but they naturally arise with perturbations and interact with other wave dynamics. The associated frequency is $\omega_s = c_s k_\parallel$.



\subsubsection{Shear Alfvén waves}
\label{ssec:edge_shearAlfvenWaves}

They appear as one introduces electromagnetic induction to the parallel electric field $E_\parallel = -\grad_\parallel \Phi - \partial_t A_\parallel$. The parallel magnetic vector potential in turn is known from the parallel current via Ampère's law.

\begin{align}
	\grad\cdot\left[\frac{m_i n_i}{ B^2}\partial_t\grad_\perp\Phi\right] &= \grad\cdot(j_\parallel\mathbf{b}) \\
	\grad^2_\perp A_\parallel &= -\mu_0j_\parallel \\
	\eta_\parallel j_\parallel &= \left(-\grad_\parallel\Phi - \partial_t A_\parallel + T_e\grad_\parallel\log(n_e)\right) \\
	\partial_t n_e &= \frac{1}{e}\grad\cdot (j_\parallel\mathbf{b}) ¸
	\label{eq:fourFieldModel}
\end{align}

It will modify the parallel current, and introduce a new wave dynamics that travel at the Alfvén velocity $v_A = \frac{B}{\sqrt{m_in_i\mu_0}}$. The dispersion relation for the system above is:

\begin{equation}
	\label{eq:dispersionRelation}
	\omega_A^2 = \left(v_A^2 + \frac{T_0 k_\perp^2}{n_e \mu_0}\right) k_\parallel^2 - \frac{\eta_\parallel^2}{4\mu_0^2}
\end{equation}

In the zero-resistivity limit, the dispersion relation has a single real solution. It describes shear Alfvén, travelling in parallel direction along magnetic field lines at the Alfvén velocity $v_A$.


\subsubsection{Resistive ballooning modes}

Magnetic curvature also plays an important role in the formation of drift waves. The effective gravity force opposes the pressure gradient, leading to inherent plasma instability and the development of resistive ballooning modes\cite{hastie2003drift}. In the vorticity conservation equation, as given in Eq. \ref{eq:edge_vorticityConservation}, the term $ \nabla \cdot \mathbf{v}_\perp $ appears. Both the electric and diamagnetic drifts take the form $ ( \mathbf{B} \times \nabla X)/B^2 $. In a homogeneous magnetic field, as assumed above, the divergence of the drifts vanishes. However, in a curved magnetic field, this term introduces additional coupling between the vorticity and the density and potential gradients. It is particularly pronounced at the low-field side, and plasmas blobs traveling outwards typically take a jelly shape. \\
In a realistic tokamak configuration with both poloidal and toroidal field components and a high aspect ratio $ R/a $, poloidal perturbations can be expressed as $ \tilde{X} = \sum_m \tilde{X}_m e^{im\theta} $. A perturbation mode $m$ in the density or potential is then coupled to the modes $ m-1 $ and $ m+1 $ of the other field. The common phenomenon is the appearance of geodesic acoustic modes that have been well-observed and described in real and numerical experiments\cite{conway2021geodesic}. They occur, for a major radius $R_0$ and local safety factor $q$, at the frequency:

\begin{equation}
	\omega^2_{GAM} = \frac{2c_s^2}{R_0^2}\left(1+\frac{1}{2q^2}\right)
\end{equation}

\vspace{2cm}

So far we have considered several wave dynamics in the plasma individually, with each their own characteristic frequency. In reality, all these modes impact the plasma simultaneously and the actual linear behavior is far more complex and combines all frequencies. In a mid-sized tokamaks such as TCV, edge plasma is found with the typical conditions: $n=10^{19}$m$^{-3}$, $T_e=T_i=50$eV, $\lambda_p=0.01$m and $B=1$T. For a pure deuterium plasma, we the characteristic times for drift waves, GAM modes, shear Alfvén waves, ion and electron transit are then of the order of:
 
\begin{align}
	\label{eq:desc_typicalTimes}
	\tau_* &= 10^{-6}\text{s} & \tau_{GAM} &= 10^{-5}\text{s} & \tau_A &=  5\cdot10^{-7}\text{s} & \tau_i &=  10^{-4}\text{s} & \tau_e &=  10^{-6}\text{s}  
\end{align}


Leddy \emph{et al.}\cite{leddy2015validity} compared the linear behavior of drift-reduced and full-velocity descriptions of plasmas. They found that while the drift reduction suppresses fast wave dynamics, easing timestep constraints and motivating the use of reduced MHD models as introduced in Sec. \ref{ssec:desc_reducedMHD}, the linear behavior of the two approaches only agrees within a limited parameter space, generally including tokamak conditions. However, the agreement is only robust in the edge region, with significant discrepancies appearing in the core, limiting the validity of drift-reduced models in simulation that consider both sides of the separatrix.




\section{Electromagnetic effects in edge plasma}
\label{sec:edge_EMeffects}

Numerous studies have demonstrated the electromagnetic effects on edge dynamics, both on blob dynamics in simple geometries\cite{lee2015, Stepanenko_2020}, and on turbulence and transport properties in real tokamak geometries\cite{zhu2023, zholobenko_2024}. Their impact increases with $\beta$ and can become crucial, particularly when approaching the L-H transition or in large machines like ITER operating in the high confinement mode (H-mode)\cite{zholobenko_2024}. In these electromagnetic models, magnetic fluctuations are explicitly determined by Ampère's and Ohm’s laws\cite{DUDSON_2009, Ricci_2012, dudson2015, stegmeir2019, giacomin2022gbs, zhang2024}. Thus, electron inertia is retained, and magnetic effects occur both through magnetic induction and flutter. 

Magnetic induction is captured by the time derivative of the parallel vector potential $A_\parallel$, which is principally a linear phenomenon, with the Coulomb gauge $E_\parallel = - \grad_\parallel \Phi - \partial_t A_\parallel$, such that fluctuations in the electrostatic potential induce magnetic fluctuations. Magnetic flutter\cite{callen_1977}, on the other hand, refers to additional transport by magnetic fluctuations appearing through the perturbed parallel gradient such as $A_\parallel = (\boldsymbol{b} + \boldsymbol{\tilde{B}}/B) \cdot \nabla$ (where $\boldsymbol{b}$ is the equilibrium magnetic field unit vector and $\boldsymbol{\tilde{B}} = \nabla \times (\tilde{A}_\parallel \boldsymbol{b})$), involving purely nonlinear phenomena. However, up to very recently, most studies did not discuss these effects, as pure electrostatic simulations are very difficult to achieve with their explicit time solvers\cite{stegmeir2019, giacomin2022gbs} and the consequent high constraints on the timestep size. \\


One particular interaction we want to study is the impact of electromagnetic effects on edge plasma turbulence. Shear Alfvén waves have already been introduced above, however they travel at much higher speeds than drift waves. In this section, we focus more on drift-Alfvén waves, which appear with the presence of a magnetic induction term in the non-adiabatic response. We then discuss the nonlinear impact of fluctuations of the magnetic equilibrium on the plasma.


\subsection{Non-adiabatic plasma response in Ohm's law}

As early as 1997, Scott\cite{scott1997} questioned the importance of magnetic induction for the evolution of drift waves. The parallel current density in Ohm's law balances the plasma pressure with electric forces and resistive friction. As soon as we consider a finite $\beta$, the variation of the electromagnetic vector potential $\mathbf{A}$ adds to the electric potential gradient in the definition of the electric field $ \mathbf{E} = -\partial_t \mathbf{A} - \grad \Phi$. At drift scales, $k_\parallel \ll k_\perp$ and only the parallel component $A_\parallel = \mathbf{A}\cdot\mathbf{b}$ of the electromagnetic potential effectively impacts electric forces. It is directly linked to the current density via Ampère's law: 

\begin{equation}
	\label{eq:edge_AmpereLaw}
	\grad\cdot\grad A_\parallel = -\mu_0 j_\parallel
\end{equation}

If we then include $A_\parallel$ in the parallel electric field, magnetic induction leads to an extended, electromagnetic Ohm's law:

\begin{align}
	\label{eq:edge_EparaElectromagnetic}
	E_\parallel = -\grad_\parallel \Phi - \partial_tA_\parallel \\
	\label{eq:edge_electromagneticOhmsLaw}
	\eta_\parallel j_\parallel = -\grad\Phi -\partial_t A_\parallel + \frac{1}{n_e}\grad_\parallel p_e + 0.71\grad_\parallel T_e
\end{align}

Magnetic induction introduces drift Alfvén waves to the system with a velocity $v_A^2 = B^2/(m_i \mu_0 n_i)$. Because of the interplay between Ampère's (\ref{eq:edge_AmpereLaw}) and Ohm's (\ref{eq:edge_electromagneticOhmsLaw}) laws, the magnetic induction term quickly dominates over the parallel resistivity. This occurs as soon as the perpendicular scale exceeds the collisionless skin depth, or if $\beta > \left(k_\perp\rho_s\right)^2(m_e/m_u)$\cite{mikhailovskii1963stability}. In drift-wave turbulence the characteristic scales may be much larger then the Larmor radius, in which case electromagnetic effects are dominant even at plasmas with low $\beta$ values of $10^{-6}$\cite{scott1997}. It is apparent that magnetic induction strongly impacts the response of the parallel current to the force balance and as such wave speeds in the plasma. For higher $\beta$, it essentially replaces the electric resistivity as the driver of the current response. Furthermore, magnetic curvature adds a layer of instability to the system and reinforces the phase shift of $\tilde{p}$ ahead of $\tilde{\Phi}$. Ballooning does, however, not modify the mode structure and thus the general shape and scale of the turbulence\cite{scott1997three}. \\ 

Dudson \emph{et al.}\cite{Dudson2021} further pointed out that a uniquely resistive current response does not prevent the Alfvén velocity to exceed the speed of light. It occurs particularly in the upper $k_\perp$ limit. With electron inertia the parallel transport is limited the thermal electron speed and hence within physical realistic values. Electron inertia effects are then needed to complete the resistive dissipation in Ohm's law. Incidentally, studies on HSX have shown that electron inertia effect may, in fact, dominate over resistivity for the generation of resistive ballooning modes\cite{rafiq2009unified}. In our model, we introduce a transport term on the parallel current to Ohm's law: 

\begin{equation}
	\label{eq:electromagneticElectronInertiaOhmsLaw}
	\eta_\parallel j_\parallel + \frac{m_e}{e}\left(\partial_t + v_j\cdot\grad\right)j_\parallel = -\grad\Phi - \partial_t A_\parallel  + \frac{1}{n_e}\grad_\parallel p_e + 0.71\grad_\parallel T_e
\end{equation}

In his later paper\cite{scott2003}, Scott identified three effective parameters that will determine whether the non-adiabatic plasma response is rather dominated by resistive effects, electron inertia or magnetic induction. They are scaled versions of the parallel resistivity $\eta_\parallel$, the electron-to-ion mass ratio and the pressure ratio $\beta$. 

\begin{align}
	C &= \eta\left(\frac{qR}{L_\perp}\right)^2	&
	\mu_{eff} &= \frac{m_e}{m_i}\left(\frac{qR}{L_\perp}\right)^2 &
	\beta_{eff} &= \beta\left(\frac{qR}{L_\perp}\right)^2
\end{align} 




\subsection{Electromagnetic flutter}

So far, we only discussed magnetic induction in Ohm's law. The magnetic potential $\textbf{A}$, in its primary definition, drives the magnetic field itself. The magnetic field can be decomposed in equilibrium and fluctuation components:

\begin{equation}
	\mathbf{B} = \mathbf{B}_{eq} + \mathbf{\tilde{B}}
\end{equation}

The fundamental definition \ref{eq:intro_magneticVectorPotential} of the magnetic field through its vector potential will be used. In the drift-reduced framework, we only consider the parallel projection of the magnetic vector potential $\mathbf{A} \approx A_\parallel\mathbf{b}$. It is then possible to calculate the fluctuating field $\mathbf{\tilde{B}}$:

\begin{equation}
	\mathbf{\tilde{B}} = \grad A_\parallel\cross\mathbf{b}_{eq} + A_\parallel \grad\cross \mathbf{b}_{eq}
\end{equation}

The second term contains the plain $A_\parallel$ without its derivative, which might seem counterintuitive from the the definition of the magnetic field and contradicts any gauge theory. The contribution of this second term to the flutter field is however negligible compared to the first. Notwithstanding the smallness of the flutter field, it is important to maintain the total magnetic field divergence-free. Let us verify this property with the definition of the flutter field:

\begin{align}
	\grad\cdot\mathbf{B} &= \grad\cdot B\mathbf{b}_{eq} + \grad\cdot B\mathbf{\tilde{b}} \nonumber \\
	&= -\beta_0\mathbf{b}_{eq} \times \nabla \tilde{A}_\parallel + \beta_0\tilde{A}_\parallel \nabla \times \mathbf{b}_{eq} \nonumber \\
	&= \beta_0\left[-\left(\grad\cross\mathbf{b}_{eq}\right)\cdot\grad A_\parallel + \mathbf{b}_{eq}\cdot\left(\grad\cross\grad A_\parallel\right) + A_\parallel\grad\cdot\left(\grad\cross\mathbf{b}_{eq}\right) + \grad A_\parallel\cdot\left(\grad\cross\mathbf{b}_{eq}\right)\right] \nonumber \\
	&= 0
\end{align}

The equilibrium field is externally provided such that it is divergence free, so $\grad\cdot B\mathbf{b}_{eq} = 0$. We further used the vector calculus identities on second-order derivatives $\grad\cross\grad X = 0$ and $\grad\cdot\left(\grad\cross\mathbf{X}\right)$. It further proves the importance of the second (small) term in the definition of $\mathbf{\tilde{b}}$ (with $\grad\cross\mathbf{b}_{eq}$), as without it, the flutter field would not be divergence-free. On the other hand, this term is problematic with respect to gauge-fixing. The field $A_\parallel$ appears directly in the equation without derivative. This is in contradiction with gauge theory, which says that the electromagnetic vector potential is defined up to a constant. This problem appears at all because we do not take the entire vector potential $\textbf{A}$, but only its projection on the parallel equilibrium direction. \\
 
With respect to the equilibrium field, flutter can be viewed as an additional drift acting on the plasma. In reality it is not an actual drift as flutter transport is in fact a deformation of the magnetic field lines and a redirection of the parallel advection. \\

Introducing electromagnetic effects, and specifically flutter, to the drift-reduced equations reduces the gap to MHD descriptions of plasma presented in Sec. \ref{ssec:desc_reducedMHD}. There are however some considerable difference: Instead of the parallel current and magnetic vector potential, the MHD model retains only their toroidal component. The magnetic vector potential there is then self-similar to the poloidal flux function $A_\varphi = \Psi$. With the knowledge of $\Psi$, the exact poloidal field is reconstructed for example in JOREK\cite{hoelzl2021jorek}. Magnetic reconnection and island formation is fundamental for tearing modes, and it remains uncertain if the fluctuating approach pursued here is sufficient to capture electromagnetic dynamics at the machine scale.  \\

A major difference remains in the targeted physics: drift-reduced codes are suited for a precise description of edge turbulence driven by drift-wave and interchange instabilities, while MHD codes focus on large-scale MHD instabilities such as ELMs\cite{pamela2017recent} or disruptions\cite{nardon2016progress}. Even if the necessary physics was available in SOLEDGE3X or other fluid codes, their specialization on drift waves requires low timestep sizes for dynamics at the microsecond scale (see Eq. \ref{eq:desc_typicalTimes}), making it extremely expensive to simulate a type-I ELM cycle that can last up to 100ms.



\subsection{Drift-Alfvén waves}
\label{sec:edge_DAW}

In this section, we take a more formal approach to the interaction between the three new terms (magnetic induction, electron inertia and flutter) and the well-known resistive drift-wave instabilities. As they all terms appear in Ohm's law, this is the place where they will all compete and modify the non-adiabatic response of the plasma. 

\subsubsection{Dispersion relation}
\label{ssec:edge_DAW_dispersionRelation}

Let us consider the same system as in Sec. \ref{ssec:edge_nonAdiabaticResponse} and combine it with the shear Alfvén dynamics from Sec. \ref{ssec:edge_shearAlfvenWaves}. We then have the system: 

\begin{align}
	\partial_t n + \mathbf{v}_E\cdot\nabla n &= \frac{1}{e}\nabla\cdot(j_\parallel \mathbf{b}) \\
	\frac{nm_i}{B^2}\partial_t\nabla_\perp^2\Phi &= \nabla\cdot(j_\parallel \mathbf{b}) \\
	\left(\eta_\parallel + \frac{m_e}{n_ee^2}\partial_t \right) j_\parallel &= \frac{T_e}{n}\grad_\parallel n - \grad_\parallel \Phi - \partial_t A_\parallel \\
	\nabla_\perp^2 A_\parallel &= -\mu_0 j_\parallel
\end{align}

Here parallel gradients and divergence use the total magnetic field $\mathbf{b}$. As in the previous setting the equilibrium field is purely toroidal and $\mathbf{b}_{eq} = (0,0,1)^T$. Again, only consider poloidal and toroidal perturbations with respective wavenumbers $k_\perp$ and $k_\parallel$. If we only consider the dominating term of $\mathbf{\tilde{b}}$, any gradient $\grad_\parallel f$ can be expressed as:

\begin{align}
	\mathbf{b}\cdot\grad f &= \mathbf{b}_{eq}\cdot\grad f + \mathbf{\tilde{b}} \cdot \grad f \nonumber\\
	&= \mathbf{b}_{eq}\cdot\grad f + \frac{1}{B}(\grad A_\parallel \cross \mathbf{b})\cdot\grad f \nonumber\\ 
	&= \partial_\varphi f + \frac{1}{B}\left[A_\parallel,f\right]_{\psi,\theta}
\end{align}

One can see from this expression the similarity between the flutter contribution to the advection and the "ExB" advection in Eq. \ref{eq:edge_poissonBracket}, reassuring us in the idea to consider flutter as a new drift. Parallel divergences can be written in the exact same way, as on a slab geometry the terms $f\partial_\psi\partial_\theta A_\parallel$ and $f\partial_\theta\partial_\psi A_\parallel$ cancel out.

\begin{equation}
	\grad \cdot (f\mathbf{b}) = \partial_\varphi f + \frac{1}{B}\left[A_\parallel,f\right]_{\psi,\theta}
\end{equation}

From the thermodynamic force, radial density gradients are prescribed to $n_0 / \lambda_p$, but $\partial_\psi\Phi$, $\partial_\psi j_\parallel$ or $\partial_\psi A_\parallel$ are assumed to zero in the linear analysis. The system of study can then be rewritten as:
\begin{align}
	\partial_t n - \frac{n_0}{B\lambda_p}\partial_\theta\Phi - \frac{1}{e}\partial_\varphi j_\parallel &= 0 \\
	\frac{nm_i}{B^2}\partial_t\nabla_\perp^2\Phi - \partial_\varphi j_\parallel &= 0\\
	\left(\eta_\parallel + \frac{m_e}{n_ee^2}\partial_t \right) j_\parallel - \frac{T_e}{n_0}\partial_\varphi n + \partial_\varphi \Phi  + \left(\frac{T_e}{\partial_t - B\lambda_p}\partial_\theta\right) A_\parallel &= 0 \\
	\partial_\theta^2 A_\parallel + \mu_0 j_\parallel &= 0
\end{align}

This system can now be transformed to the Fourier space:

\begin{equation}
	\begin{pmatrix}
		-i\omega                  & i\frac{n_0}{T_0}\omega_*    & -i\frac{1}{e}k_\parallel & 0                  \\ 
		0                         & i\frac{en_0}{T_0}\rho_L^2k_\perp^2\omega        & -ik_\parallel            & 0                  \\ 
		-i\frac{T_0}{n_0}k_\parallel & ik_\parallel & \eta_\parallel - i\frac{m_e}{(n_ee^2)}\omega & i\omega_* - i\omega \\ 
		0                         & 0                             & \mu_0                   & -k_\perp^2
	\end{pmatrix}\begin{pmatrix}
		\hat{n} \\ \hat{\Phi} \\ \hat{j}_\parallel \\ \hat{A}_\parallel
	\end{pmatrix} = \begin{pmatrix}
		0 \\ 0 \\ 0 \\ 0
	\end{pmatrix}
\end{equation}

To get the complex system frequencies, we need to solve the determinant of the matrix for $\omega$. We can express the dispersion relation as a third order polynomial equation on $\omega$:
´\begin{equation}
	\label{eq:edge_DAWdispersionRelation}
	i\left(\underbrace{\rho_{L,e}^2k_\perp^2}_{\text{finite }m_e} + \underbrace{\beta_0}_{\text{induct.}}\right)\omega^3 + \left(-\underbrace{i\beta_0\omega_*}_{\text{flutter}} - \underbrace{\frac{\eta_\parallel en_0T_0k_\perp^2}{B^2}}_{\text{resistivity}}\right)\omega^2 - i\omega_s^2\left(\omega_*-\left(1 + \rho_L^2 k_\perp^2\right)\omega\right) = 0
\end{equation}

with the electron Larmor radius $\rho_{L,e}^2 = m_eT_0/(eB^2)$ and the pressure ratio $\beta_0 = en_0T_0 \mu_0 / B^2$. The terms arising from the different components of the electromagnetic model are clearly labeled. 

%For more clarity in the upcoming
%\begin{equation}
%	\left[i\rho_{L,e}^2k_\perp^2 \omega + i\beta_0\left(\omega - \omega_*\right)- \frac{\eta_\parallel en_0T_0k_\perp^2}{B^2}\right]\omega^2 - \omega_s^2\left(\omega-\omega_*\right) = 0
%\end{equation}


\subsubsection{Perturbative solution}
\label{ssec:edge_DAW_perturbativeSolution}


The solution to the dispersion relation takes the form $\omega_{DAW} = \omega_0 +i\gamma$. To obtain a neat expression for the wave phase frequency $\omega_0$ and the growth rate $\gamma$, let us assume that the drift-Alfvén frequency $\omega_{DAW}$ is close to the diamagnetic frequency, with $\delta = \omega_{DAW} - \omega_*$ such that higher orders $\delta^n$ can be ignored. To improve the readability, let us refer to the resistive term as $R = \eta_\parallel en_0T_0/B^2$. We can then express $\delta$: 

\begin{align}
	\delta &= \frac{Rk_\perp\omega_*^2 - i\rho_{L,e}^2k_\perp^2\omega_*^3}{i\left(\beta_0 - 3\rho_{L,e}^2k_\perp^2\right)\omega_*^2 - 2Rk_\perp\omega_* - i\omega_s^2} %\\
	%&= \frac{\omega_*^{3} \left(- 2 R^2 + k_\perp^2 \rho_{L,e}^2 \left(c_{s}^2 k_\parallel^2 - \omega_*^2 \left(\beta_{0} + 3 k_\perp^2 \rho_{L,e}^2\right)\right)\right)}{4 R^2 \omega_*^2 + \left(c_{s}^2 k_\parallel^2 - \omega_*^2 \left(\beta_{0} + 3 k_\perp^2 \rho_{L,e}^2\right)\right)^2} + i\frac{R \omega_*^2 \left(c_{s}^2 k_\parallel^2 + 2 k_\perp^2 \omega_*^2 \rho_{L,e}^2 - \omega_*^2 \left(\beta_{0} + 3 k_\perp^2 \rho_{L,e}^2\right)\right)}{4 R^2 \omega_*^2 + \left(c_{s}^2 k_\parallel^2 - \omega_*^2 \left(\beta_{0} + 3 k_\perp^2 \rho_{L,e}^2\right)\right)^2}
\end{align}

If we further assume a small but still finite resistivity $R$ (dropping higher-order terms), we can concisely express the real and imaginary parts of $\delta$.

\begin{equation}
	\delta \approx \frac{\rho_{L,e}^2k_\perp^{2} \omega_*^{3} }{\left(\beta_{0}  - 3 \rho_{L,e}^2 k_\perp^{2}\right)\omega_*^{2} + \omega_s^{2}} + i\frac{Rk_\perp\omega_*^{2}}{\left(\beta_{0}  - 3 \rho_{L,e}^2 k_\perp^{2}\right)\omega_*^{2} + \omega_s^{2} }	
\end{equation}

At this point, a single term remains for electromagnetic induction and flutter. This is because the flutter has a stabilizing effect on the inductive term. It already appears in the dispersion relation \ref{eq:edge_DAWdispersionRelation} that the flutter term largely compensates the electromagnetic induction in the difference $i\beta_0\left(\omega - \omega_*\right)\omega^2$. 

%Without the flutter correction, one would get for $\delta$:
%
%
%\begin{equation}
%	\delta \approx \frac{\rho_{L,e}^2k_\perp^{2} \omega_*^{3} }{\left(\beta_{0}  - 3 \rho_{L,e}^2 k_\perp^{2}\right)\omega_*^{2} + \omega_s^{2}} + i\frac{Rk_\perp\omega_*^{2}}{\left(\beta_{0}  - 3 \rho_{L,e}^2 k_\perp^{2}\right)\omega_*^{2} + \omega_s^{2} }	
%\end{equation}
%

it is interesting to discuss how the electromagnetic terms modify the characteristic drift-wave frequency $\omega_*$ known from the electrostatic setting. Since we estimated the drift-Alfvén wave by $\omega_{DAW} = \omega_* + \delta$, it is also essential to justify the assumptions made above. For that, let us compare of $\delta$ to the diamagnetic frequency. 

\begin{equation}
	\frac{\Re{\delta}}{\omega_*} = \frac{\rho_{L,e}^2k_\perp^{2} \omega_*^{2} }{\left(\beta_{0}  - 3 \rho_{L,e}^2 k_\perp^{2}\right)\omega_*^{2} + \omega_s^{2} }
\end{equation}

The resistive terms do not contribute to a change of frequency. 

This discussion is only valid in cases where $\rho_L^2k_\perp^2$ is small and hence $\omega_{DAW}$ is close to the diamagnetic frequency $\omega_*$. 




